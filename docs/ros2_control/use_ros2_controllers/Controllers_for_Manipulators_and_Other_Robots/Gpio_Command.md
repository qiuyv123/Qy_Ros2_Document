# gpio_controllersï¼ˆGPIO æ§åˆ¶å™¨ï¼‰

`gpio_controllers` æ˜¯ä¸€ç»„ç”¨äºç®¡ç† **GPIO ç±»å‹ç¡¬ä»¶æ¥å£**ï¼ˆURDF ä¸­é€šè¿‡ `<gpio>` æ ‡ç­¾å®šä¹‰ï¼‰çš„æ§åˆ¶å™¨ã€‚

---

## `gpio_command_controller`

`gpio_command_controller` å…è®¸ç”¨æˆ·ï¼š
- **æš´éœ²æŒ‡å®š GPIO æ¥å£çš„å‘½ä»¤æ¥å£**
- **å‘å¸ƒå·²é…ç½®å‘½ä»¤æ¥å£å¯¹åº”çš„çŠ¶æ€æ¥å£**

### æ§åˆ¶å™¨æ¥å£è¯´æ˜

#### å‘å¸ƒè€…ï¼ˆPublishersï¼‰
- **`/<controller_name>/gpio_states`**ï¼ˆ`control_msgs/msg/DynamicJointState`ï¼‰  
  å‘å¸ƒæ‰€æœ‰å·²é…ç½®çš„ GPIO çŠ¶æ€æ¥å£æ•°æ®ã€‚

#### è®¢é˜…è€…ï¼ˆSubscribersï¼‰
- **`/<controller_name>/commands`**ï¼ˆ`control_msgs/msg/DynamicJointState`ï¼‰  
  æ¥æ”¶é’ˆå¯¹å·²é…ç½®å‘½ä»¤æ¥å£çš„æ§åˆ¶æŒ‡ä»¤ã€‚

---

## å‚æ•°ï¼ˆParametersï¼‰

æœ¬æ§åˆ¶å™¨ä½¿ç”¨ `generate_parameter_library` ç®¡ç†å‚æ•°ã€‚å®Œæ•´è¯´æ˜è§ `src/` ç›®å½•ä¸‹çš„å‚æ•°å®šä¹‰æ–‡ä»¶ã€‚

### æ ¸å¿ƒå‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ | çº¦æŸ | åªè¯» |
|------|------|--------|------|------|------|
| `gpios` | `string_array` | â€” | GPIO åç§°åˆ—è¡¨ | é•¿åº¦ > 0ã€æ— é‡å¤ | âœ… |

### æ¥å£é…ç½®ï¼ˆæŒ‰ GPIO åˆ†ç»„ï¼‰

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ | çº¦æŸ | åªè¯» |
|------|--------|------|------|------|
| `command_interfaces.<gpio>.interfaces` | `{}` | è¯¥ GPIO çš„å‘½ä»¤æ¥å£åˆ—è¡¨ | æ— é‡å¤ | âœ… |
| `state_interfaces.<gpio>.interfaces` | `{}` | è¯¥ GPIO çš„çŠ¶æ€æ¥å£åˆ—è¡¨ã€‚<br>è‹¥ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨è¯¥ GPIO **æ‰€æœ‰å¯ç”¨çŠ¶æ€æ¥å£** | æ— é‡å¤ | âœ… |

> âš ï¸ **åˆå§‹åŒ–è¦æ±‚**ï¼š
> - å¿…é¡»è‡³å°‘ä¸ºä¸€ä¸ª GPIO é…ç½®**å‘½ä»¤æ¥å£æˆ–çŠ¶æ€æ¥å£**
> - è‹¥å‚æ•°æ–‡ä»¶ä¸­**æ—¢æœªæä¾›å‘½ä»¤ä¹Ÿæœªæä¾›çŠ¶æ€æ¥å£**ï¼Œæ§åˆ¶å™¨å°†åœ¨åˆå§‹åŒ–æ—¶**å¤±è´¥**
>
> ğŸ“Œ **è¡Œä¸ºè¯´æ˜**ï¼š
> - è‹¥**æœªé…ç½®å‘½ä»¤æ¥å£**ï¼Œæ§åˆ¶å™¨é€€åŒ–ä¸º **å¹¿æ’­å™¨**ï¼ˆbroadcasterï¼‰ï¼Œä»…å‘å¸ƒçŠ¶æ€
> - è‹¥**æœªé…ç½®çŠ¶æ€æ¥å£**ï¼Œåˆ™ä¸å‘å¸ƒè¯¥ GPIO çš„çŠ¶æ€

---

## ç¤ºä¾‹é…ç½®

```yaml
gpio_command_controller:
  ros__parameters:
    type: gpio_controllers/GpioCommandController
    gpios:
      - Gpio1
      - Gpio2
    command_interfaces:
      Gpio1:
        interfaces:
          - dig.1
          - dig.2
          - dig.3
      Gpio2:
        interfaces:
          - ana.1
          - ana.2
    state_interfaces:
      Gpio2:
        interfaces:
          - ana.1
          - ana.2
```

### è¡Œä¸ºè¯´æ˜
- æ§åˆ¶å™¨å°†**æ¥æ”¶æ‰€æœ‰ GPIO çš„å‘½ä»¤**ï¼ˆGpio1 çš„ 3 ä¸ªæ•°å­—æ¥å£ + Gpio2 çš„ 2 ä¸ªæ¨¡æ‹Ÿæ¥å£ï¼‰
- **ä»…å‘å¸ƒ Gpio2 çš„çŠ¶æ€**ï¼ˆ`ana.1` å’Œ `ana.2`ï¼‰  
- Gpio1 çš„çŠ¶æ€**ä¸ä¼šè¢«å‘å¸ƒ**ï¼ˆå› å…¶ `state_interfaces` æœªé…ç½®ï¼‰